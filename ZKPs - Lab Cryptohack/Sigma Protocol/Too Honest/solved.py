# from pwn import *
# import json
# from Crypto.Util.number import long_to_bytes, inverse
# from sympy.ntheory.residue_ntheory import discrete_log

# def connect_and_get_data(e):
#     conn = connect('socket.cryptohack.org', 13429, level='debug')
#     conn.recvline() 
#     msg = json.loads(conn.recvline().decode())
#     y = msg["y"]
#     a = msg["a"]
#     conn.sendline(json.dumps({"e": e}))
#     response = json.loads(conn.recvline().decode())
#     z = response["z"]
#     conn.close()
#     return y, a, z

# k1 = 512
# k2 = 128
# e1 = 0
# g = 2
# y1, a1, z1 = connect_and_get_data(e1)
# N = 63506177426384102189597350894327047299059434133653566917776601666605133716653510828029111986956978773016660313963972378811186153674164948861199369871734498221215139927864142313488277305751745855210473314367642273303159704466900274761354992859789827863358153922459760984397971477173435625199596782211170294424560686178858124003120741008270927463303483018910205943877584647744143454984243979284973117132536957364157878132874844783228762221620863204335896952103079109039534346621267709606103312376393511653638269034043434410564414042523141936372609708140474052147124354400977541403247799192906955295291389109531010594317

# z = z1 - 1
# print(z)

from Crypto.Util.number import*
from pwn import *
import json

N = 63506177426384102189597350894327047299059434133653566917776601666605133716653510828029111986956978773016660313963972378811186153674164948861199369871734498221215139927864142313488277305751745855210473314367642273303159704466900274761354992859789827863358153922459760984397971477173435625199596782211170294424560686178858124003120741008270927463303483018910205943877584647744143454984243979284973117132536957364157878132874844783228762221620863204335896952103079109039534346621267709606103312376393511653638269034043434410564414042523141936372609708140474052147124354400977541403247799192906955295291389109531010594317

f = connect('socket.cryptohack.org', 13429, level='debug')
f.recvline() 
msg = json.loads(f.recvline().decode())
y = msg["y"]
a = msg["a"]
f.sendline(json.dumps({"e": 2**512}))
response = json.loads(f.recvline().decode())
z = response["z"]
print(long_to_bytes(z))
f.close()

